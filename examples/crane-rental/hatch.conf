# Crane Rental - hatch configuration
# Place this in the crane-rental project root (or ~/.hatch/projects/crane-rental.conf)

PROJECT_NAME="crane-rental"
PACKAGE_MANAGER="yarn"

# Docker services from docker-compose.yaml
DOCKER_SERVICES="
  contember-engine:4000
  postgres:5432
  minio:9000
  mailhog:8025
"

DOCKER_EXTRAS="adminer:8080"

# Dev servers
DEV_SERVERS="
  admin:admin:vite --port {PORT} --strictPort --host 0.0.0.0 --mode dev:10
  scan:scan:vite --port {PORT} --strictPort --host 0.0.0.0 --mode dev:11
  worker:worker:wrangler dev --env local --port {PORT} -c wrangler.toml -c ./slaves/pdf-generator/wrangler.toml -c ./slaves/email-renderer/wrangler.toml src/index.ts:12
"

# Static secrets written to workspace files during setup
SECRETS="
  admin/.env.local:VITE_CONTEMBER_ADMIN_SESSION_TOKEN=0000000000000000000000000000000000000000
  admin/.env.local:VITE_CONTEMBER_ADMIN_PROJECT_NAME=crane-rental-management
  scan/.env.local:VITE_CONTEMBER_ADMIN_SESSION_TOKEN=0000000000000000000000000000000000000000
  scan/.env.local:VITE_CONTEMBER_ADMIN_PROJECT_NAME=crane-rental-management
  scan/.env.local:VITE_MODE=local
"

# Dynamic port injection into config files
PORT_TEMPLATES="
  admin/.env.local:VITE_CONTEMBER_ADMIN_API_BASE_URL=http://localhost:{PORT_contember-engine}
  admin/.env.local:VITE_WORKER_URL=http://localhost:{PORT_worker}
  scan/.env.local:VITE_CONTEMBER_ADMIN_API_BASE_URL=http://localhost:{PORT_contember-engine}
  scan/.env.local:VITE_WORKER_URL=http://localhost:{PORT_worker}
  worker/.dev.vars:CONTEMBER_API_URL=http://localhost:{PORT_contember-engine}/content/crane-rental-management/live
  worker/.dev.vars:ADMIN_URL=http://localhost:{PORT_admin}
  worker/.dev.vars:CONTEMBER_API_TOKEN=0000000000000000000000000000000000000000
  worker/.dev.vars:CONTEMBER_ACTIONS_SECRET_KEY=2222222222222222222222222222222222222222
"

# MCP servers
MCP_SERVERS="
  crane-rental:npx:tsx mcp/host/src/index.ts
"

MCP_ENV="
  crane-rental:CONTEMBER_API_URL=http://localhost:{PORT_contember-engine}/content/crane-rental-management/live
  crane-rental:CONTEMBER_API_TOKEN=0000000000000000000000000000000000000000
  crane-rental:ENVIRONMENT=local
"

# Migrations
MIGRATE_TOOL="contember"
MIGRATIONS_DIR="api/migrations"
MIGRATIONS_FILE_EXT="json"

# Data import/export (functions defined in hatch.hooks.sh)
DATA_IMPORT_CMD="crane_rental_import"
DATA_EXPORT_CMD="crane_rental_export"

# Database
DB_USER="contember"
DB_PASSWORD="contember"
DB_NAME="contember"

# Setup steps
SETUP_STEPS="docker:up migrate:execute_until data:import migrate:execute custom:crane_rental_setup"

# Post-install command
POST_INSTALL_CMD="yarn client:generate"

# Hooks
HOOKS_FILE="hatch.hooks.sh"
